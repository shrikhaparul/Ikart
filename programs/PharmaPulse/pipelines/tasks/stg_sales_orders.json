{
  "task_id": 484,
  "pipeline_id": 170,
  "task_name": "stg_sales_orders",
  "task_type": "SQL Execution",
  "sql_execution": {
    "connection_name": "postgres",
    "restart": "begin"
  },
  "sql_list": [
    {
      "seq_no": 1,
      "sql_query": "SELECT c.fromcurrencycode, c.tocurrencycode, SalesOrderID, RevisionNumber, OrderDate, DueDate, ShipDate, Status, \nOnlineOrderFlag, SalesOrderNumber, PurchaseOrderNumber, AccountNumber, CustomerID, SalesPersonID, TerritoryID,  \nShipToAddressID,s.CurrencyRateID, SubTotal SubTotal_USD, SubTotal/AverageRate as SubTotal_GBP,  TaxAmt/AverageRate as SubTotal_GBP, \nTotalDue TotalDue_USD, TotalDue/AverageRate  totaldue_gbp\nFROM EverestDB.dbo.SalesOrderHeader s left join EverestDB.dbo.CurrencyRate c\non s.CurrencyRateID=c.CurrencyRateID\nwhere c.fromcurrencycode is not NULL;",
      "table_used_desc": "query to bring data from landing to stage layer for sales data"
    }
  ]
}