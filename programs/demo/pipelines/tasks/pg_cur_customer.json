{
  "task_id": 442,
  "pipeline_id": 164,
  "task_name": "pg_cur_customer",
  "task_type": "SQL Execution",
  "sql_execution": {
    "connection_name": "postgres_connection_puneeth",
    "restart": "normal"
  },
  "sql_list": [
    {
      "seq_no": 1,
      "sql_query": "truncat table curated.dim_customer_profile;",
      "table_used_desc": "truncate dim profile"
    },
    {
      "seq_no": 2,
      "sql_query": "insert into curated.dim_customer_profile \n(SELECT p.\"BusinessEntityID\"\n      ,\"PersonType\"\n      ,\"Title\"\n      ,\"FirstName\"\n      ,\"MiddleName\"\n      ,\"LastName\"\n      ,\"Suffix\"\n      ,\"EmailPromotion\"\n      ,\"Demographics\"\n      ,\"rowguid\"\n      ,pc.\"ModifiedDate\"\n  FROM raw.customer p left join \n  (SELECT \"BusinessEntityID\"\n      ,\"PhoneNumber\"\n      ,pp.\"PhoneNumberTypeID\"\n      ,pp.\"ModifiedDate\"\n\t  , pn.\"Name\" Phone_number_typ\n  FROM raw.customer_phone pp\n  left join raw.customer_phone_type pn on pp.\"PhoneNumberTypeID\"  = pn.\"PhoneNumberTypeID\") pc\n  on p.\"BusinessEntityID\" = pc.\"BusinessEntityID\")",
      "table_used_desc": "Load dimension customer profile"
    }
  ]
}