{
  "login_id": "shilpi",
  "id": 844,
  "project_name": "ingkart_project",
  "pipeline_name": "oracle_ingestion",
  "project_id": 72,
  "pipeline_id": 189,
  "task_name": "transform_ssql",
  "task_description": "transform_ssql",
  "task_type": "Transformation",
  "task_sequence": "0",
  "last_run_id": "b514b4b6-86dc-4207-94ff-167e3bd076c3",
  "status": "Failed",
  "updated_dttm": "2024-08-01T07:26:50.000Z",
  "source": "none",
  "target": "none",
  "is_active": "Y",
  "created_by": "shilpi",
  "updated_by": "shilpi",
  "job_execution": "pandas",
  "task": {
    "flow": {
      "SQL_query": "Input_data_desc",
      "Input_data_desc": "0",
      "Input_data_price": "0",
      "Input_data_detail": "0",
      "Output_check_sql_file": "SQL_query",
      "Expression_add_price_in_usd": "Input_data_price",
      "Expression_change_into_julian": "Input_data_detail"
    },
    "details": [
      {
        "Expression": [
          {
            "add_price_in_usd": {
              "input_df": "inp_aia",
              "output_df": "exp_djz",
              "transformation_name": "add_price_in_usd",
              "change_into_julian_1": {
                "operator": "",
                "sequence": "1",
                "operatorType": "",
                "input_col_name": "id",
                "output_col_name": "id",
                "expression_value": " "
              },
              "change_into_julian_7": {
                "operator": "",
                "sequence": "7",
                "operatorType": "",
                "input_col_name": "category",
                "output_col_name": "category",
                "expression_value": " "
              },
              "change_into_julian_6": {
                "operator": "",
                "sequence": "6",
                "operatorType": "",
                "input_col_name": "published_date",
                "output_col_name": "published_date",
                "expression_value": " "
              },
              "change_into_julian_5": {
                "operator": "",
                "sequence": "5",
                "operatorType": "",
                "input_col_name": "publisher",
                "output_col_name": "publisher",
                "expression_value": " "
              },
              "change_into_julian_4": {
                "operator": "",
                "sequence": "4",
                "operatorType": "",
                "input_col_name": "authors",
                "output_col_name": "authors",
                "expression_value": " "
              },
              "change_into_julian_3": {
                "operator": "",
                "sequence": "3",
                "operatorType": "",
                "input_col_name": "subtitle",
                "output_col_name": "subtitle",
                "expression_value": " "
              },
              "change_into_julian_2": {
                "operator": "",
                "sequence": "2",
                "operatorType": "",
                "input_col_name": "title",
                "output_col_name": "title",
                "expression_value": " "
              },
              "change_into_julian": {
                "input_df": "inp_knv",
                "output_df": "exp_dkf",
                "transformation_name": "change_into_julian"
              },
              "change_into_julian_8": {
                "operator": "to_julian",
                "sequence": "8",
                "operatorType": "Date and Time",
                "input_col_name": "",
                "output_col_name": "datee_in julian",
                "expression_value": "to_julian(published_date)"
              },
              "add_price_in_usd_5": {
                "operator": "currency_conv",
                "sequence": "5",
                "operatorType": "Converter",
                "input_col_name": "",
                "output_col_name": "price_usd",
                "expression_value": "currency_conv(price,INR,USD))"
              },
              "add_price_in_usd_1": {
                "operator": "",
                "sequence": "1",
                "operatorType": "",
                "input_col_name": "id",
                "output_col_name": "id",
                "expression_value": " "
              },
              "add_price_in_usd_2": {
                "operator": "",
                "sequence": "2",
                "operatorType": "",
                "input_col_name": "price",
                "output_col_name": "price_ind",
                "expression_value": " "
              },
              "add_price_in_usd_4": {
                "operator": "",
                "sequence": "4",
                "operatorType": "",
                "input_col_name": "currency_code",
                "output_col_name": "currency_code",
                "expression_value": " "
              },
              "add_price_in_usd_3": {
                "operator": "",
                "sequence": "3",
                "operatorType": "",
                "input_col_name": "retail_price",
                "output_col_name": "retail_price",
                "expression_value": " "
              }
            }
          }
        ]
      },
      {
        "Input": [
          {
            "data_price": {
              "schema": "lnd",
              "output_df": "inp_aia",
              "table_name": "databooks_price_cl",
              "source_type": "PostgreSQL",
              "select_columns": "id,price,retail_price,currency_code",
              "connection_name": "postgres_s",
              "transformation_name": "data_price"
            }
          },
          {
            "data_desc": {
              "schema": "lnd",
              "output_df": "inp_zvd",
              "table_name": "databooks_desc_cl",
              "source_type": "PostgreSQL",
              "select_columns": "id,page_count,print_type,avg_rating,rating_count,is_ebook",
              "connection_name": "postgres_s",
              "transformation_name": "data_desc"
            }
          },
          {
            "data_detail": {
              "schema": "lnd",
              "output_df": "inp_knv",
              "table_name": "databook_details_cl",
              "source_type": "PostgreSQL",
              "select_columns": "id,title,subtitle,authors,publisher,published_date,category",
              "connection_name": "postgres_s",
              "transformation_name": "data_detail"
            }
          }
        ]
      },
      {
        "Output": [
          {
            "check_sql_file": {
              "header": "Y",
              "schema": "test",
              "encoding": "utf-8",
              "input_df": "sql_cja",
              "delimiter": ",",
              "file_name": "sql_result.csv",
              "file_path": "/home/Admin/actions-runner/_work/UI/src_files2/",
              "file_type": "csv",
              "operation": "create",
              "quote_char": "",
              "table_name": "book_result",
              "compression": "",
              "target_type": "Oracle",
              "connection_name": "oracle_xepdb1",
              "transformation_name": "check_sql_file",
              "target_max_record_count": "0"
            }
          }
        ]
      },
      {
        "SQL": [
          {
            "query": {
              "input_df": "inp_zvd",
              "output_df": "sql_cja",
              "sql_query": "SELECT id\n    exp_dkf.id,exp_dkf.title,exp_dkf.subtitle,exp_dkf.authors,exp_dkf.publisher,exp_dkf.published_date,exp_dkf.category,exp_dkf.date_in_julian,inp_zvd.page_count,inp_zvd.print_type,inp_zvd.avg_rating,inp_zvd.rating_count,inp_zvd.is_ebook,exp_djz.price,exp_djz.retail_price,exp_djz.price_usd\nFROM \n    exp_dkf\nJOIN \n    inp_zvd ON exp_dkf.id= inp_zvd.id\nJOIN \n    exp_djz ON exp_dkf.﻿id = exp_djz.﻿id;",
              "transformation_name": "query"
            }
          }
        ]
      }
    ]
  }
}